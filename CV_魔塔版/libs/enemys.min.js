function enemys(){this.init()}enemys.prototype.init=function(){this.enemys=enemys_fcae963b_31c9_42b4_b48c_bb48d09f3f80;this.enemydata=functions_d6ad677b_427a_4623_b50f_a445a3b0ef8a.enemys;if(main.mode=="play"){this.enemydata.hasSpecial=function(c,d){return core.enemys.hasSpecial(c,d)}}};enemys.prototype.getEnemys=function(a){if(!core.isset(a)){return this.enemys}return this.enemys[a]};enemys.prototype.hasSpecial=function(a,b){if(!core.isset(a)){return false}if(a instanceof Array){return a.indexOf(b)>=0}if(typeof a=="number"){return a!=0&&(a%100==b||this.hasSpecial(parseInt(a/100),b))}if(typeof a=="string"){return this.hasSpecial(core.material.enemys[a],b)}if(core.isset(a.special)){return this.hasSpecial(a.special,b)}return false};enemys.prototype.getSpecials=function(){return this.enemydata.getSpecials()};enemys.prototype.calContent=function(b,a){if(typeof b=="string"){b=core.material.enemys[b]}if(typeof a=="string"){return a}if(a instanceof Function){return a(b)}return""};enemys.prototype.getSpecialText=function(a){if(typeof a=="string"){a=core.material.enemys[a]}if(!core.isset(a)){return[]}var c=a.special;var e=[];var d=this.getSpecials();if(core.isset(d)){for(var b=0;b<d.length;b++){if(this.hasSpecial(c,d[b][0])){e.push(this.calContent(a,d[b][1]))}}}return e};enemys.prototype.getSpecialHint=function(a,d){if(typeof a=="string"){a=core.material.enemys[a]}var e=this.getSpecials();if(!core.isset(d)){if(!core.isset(e)){return[]}var b=[];for(var c=0;c<e.length;c++){if(this.hasSpecial(a,e[c][0])){b.push(this.calContent(a,e[c][1])+"："+this.calContent(a,e[c][2]))}}return b}if(!core.isset(e)){return""}for(var c=0;c<e.length;c++){if(d==e[c][0]){return this.calContent(a,e[c][1])+"："+this.calContent(a,e[c][2])}}return""};enemys.prototype.canBattle=function(b,d,e,c){var a=this.getDamage(b,d,e,c);return a!=null&&a<core.status.hero.hp};enemys.prototype.getDamage=function(b,d,e,c){if(typeof b=="string"){b=core.material.enemys[b]}var a=this.calDamage(b,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef,d,e,c);if(a==null){return null}return a+this.getExtraDamage(b)};enemys.prototype.getExtraDamage=function(a){if(typeof a=="string"){a=core.material.enemys[a]}var b=0;if(this.hasSpecial(a.special,17)){b+=core.getFlag("hatred",0)}if(this.hasSpecial(a.special,22)){b+=a.damage||0}return b};enemys.prototype.nextCriticals=function(b,k,p,q,c){if(typeof b=="string"){b=core.material.enemys[b]}var o=!core.flags.useLoop;k=k||1;if(this.hasSpecial(b.special,3)){if(core.status.hero.atk<=b.def){return[[b.def+1-core.status.hero.atk,"?"]]}return[]}if(this.hasSpecial(b.special,10)){return[]}var e=this.getDamageInfo(b,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef,p,q,c);if(e==null){if(core.status.hero.atk<=b.def){return[[b.def+1-core.status.hero.atk,"?"]]}return[]}if(e.damage<=0&&!core.flags.enableNegativeDamage){return[[0,0]]}var f=[],l=null;var h=e.mon_hp,d=core.status.hero.atk,g=b.def,n=e.turn;if(o){for(var m=n-1;m>=1;m--){var i=Math.ceil(h/m)+g;if(core.flags.equipPercentage){i=Math.ceil(i/core.getFlag("equip_atk_buff",1))}if(i<=d){break}if(i!=l){var j=this.getDamageInfo(b,core.status.hero.hp,i,core.status.hero.def,core.status.hero.mdef,p,q,c);if(j==null){break}f.push([i-d,e.damage-j.damage]);if(j.damage<=0&&!core.flags.enableNegativeDamage){break}l=i}if(f.length>=k){break}}}else{l=e.damage;for(var a=d+1;a<=h+g;a++){var j=this.getDamageInfo(b,core.status.hero.hp,a,core.status.hero.def,core.status.hero.mdef,p,q,c);if(j==null){break}if(l>j.damage){l=j.damage;f.push([a-d,e.damage-j.damage]);if(j.damage<=0&&!core.flags.enableNegativeDamage){break}if(f.length>=k){break}}}}if(f.length==0){f.push([0,0])}return f};enemys.prototype.getDefDamage=function(a,c,f,g,b){if(typeof a=="string"){a=core.material.enemys[a]}c=c||1;var e=this.calDamage(a,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef,f,g,b);var d=this.calDamage(a,core.status.hero.hp,core.status.hero.atk,core.status.hero.def+c,core.status.hero.mdef,f,g,b);if(e==null||d==null){return"???"}return e-d};enemys.prototype.getEnemyInfo=function(a,e,c,d,f,g,h,b){if(typeof a=="string"){a=core.material.enemys[a]}return this.enemydata.getEnemyInfo(a,e,c,d,f,g,h,b)};enemys.prototype.getDamageInfo=function(a,e,c,d,f,g,h,b){if(typeof a=="string"){a=core.material.enemys[a]}return this.enemydata.getDamageInfo(a,e,c,d,f,g,h,b)};enemys.prototype.calDamage=function(a,e,c,d,f,h,i,b){if(typeof a=="string"){a=core.material.enemys[a]}var g=this.getDamageInfo(a,e,c,d,f,h,i,b);if(g==null){return null}return g.damage};enemys.prototype.updateEnemys=function(){return this.enemydata.updateEnemys()};enemys.prototype.getCurrentEnemys=function(h){h=h||core.status.floorId;var g=[];var q={};var l=core.status.maps[h].blocks;for(var a=0;a<l.length;a++){if(core.isset(l[a].event)&&!l[a].disable&&l[a].event.cls.indexOf("enemy")==0){var e=l[a].event.id;if(core.isset(q[e])){continue}var d=core.material.enemys[e];var o=d.hp,m=d.atk,n=d.def;var i=core.status.hero.atk,j=core.status.hero.def,k=core.status.hero.mdef;if(core.flags.equipPercentage){i=Math.floor(core.getFlag("equip_atk_buff",1)*i);j=Math.floor(core.getFlag("equip_def_buff",1)*j);k=Math.floor(core.getFlag("equip_mdef_buff",1)*k)}var f=this.getEnemyInfo(d,core.status.hero.hp,i,j,k,null,null,h);var p=core.enemys.getSpecialText(e);if(p.length>=3){p="多属性..."}else{p=p.join("  ")}var c=this.nextCriticals(e);if(c.length>0){c=c[0]}g.push({id:e,name:d.name,hp:f.hp,atk:f.atk,def:f.def,money:f.money||0,experience:f.experience||0,point:f.point||0,special:p,damage:this.getDamage(e,null,null,h),critical:c[0],criticalDamage:c[1],defDamage:this.getDefDamage(e,1,null,null,h)});q[e]=true}}g.sort(function(r,s){if(r.damage==s.damage){return r.money-s.money}if(r.damage==null){return 1}if(s.damage==null){return -1}return r.damage-s.damage});return g};