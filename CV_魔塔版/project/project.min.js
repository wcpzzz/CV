data_a1e2fb4a_e986_4524_b0da_9b7ba7c0874d={main:{floorIds:["sample0","sample1","sample2","sample3","MT0","a"],images:["bg.jpg"],tilesets:[],animates:["hand","sword","zone"],bgms:["bgm.mp3"],sounds:["floor.mp3","attack.mp3","door.mp3","item.mp3","equip.mp3","zone.mp3","jump.mp3"],startBackground:"bg.jpg",startLogoStyle:"color: black",levelChoose:[["简单","Easy"],["普通","Normal"],["困难","Hard"],["噩梦","Hell"]],equipName:["武器","盾牌"],statusLeftBackground:"url(project/images/ground.png) repeat",statusTopBackground:"url(project/images/ground.png) repeat",toolsBackground:"url(project/images/ground.png) repeat",borderColor:"white"},firstData:{title:"魔塔样板",name:"template",version:"Ver 2.4.3",floorId:"a",hero:{name:"wcpzzz",lv:1,hpmax:9999,hp:1000,atk:100,def:100,mdef:100,money:100,experience:0,equipment:[],items:{keys:{yellowKey:0,blueKey:0,redKey:0},constants:{},tools:{},equips:{}},flyRange:[],loc:{direction:"up",x:6,y:10},flags:{},steps:0},startText:["1997年5月，wcpzzz出生了。\n\n2003年9月，就读于上海市罗南中心小学，年级共约180人。","初生牛犊不怕虎，熊孩子wcpzzz自此度过了一段得意洋洋、任行天地的时光。","曾不做作业被留到晚上7点，也曾因成绩优秀当上了学委\n\n但一切都如幼儿园满墙小红花一样，也就图个追忆时的念想。","谨以此层，回忆小学时代"],shops:[{id:"moneyShop1",name:"贪婪之神",icon:"blueShop",textInList:"1F金币商店",use:"money",need:"20+10*times*(times+1)",text:"勇敢的武士啊，给我${need}金币就可以：",choices:[{text:"生命+800",effect:"status:hp+=800"},{text:"攻击+4",effect:"status:atk+=4"},{text:"防御+4",effect:"status:def+=4"},{text:"魔防+10",effect:"status:mdef+=10"}]},{id:"expShop1",name:"经验之神",icon:"pinkShop",textInList:"1F经验商店",use:"experience",need:"-1",text:"勇敢的武士啊，给我若干经验就可以：",choices:[{text:"等级+1",need:"100",effect:"status:lv+=1;status:hp+=1000;status:atk+=7;status:def+=7"},{text:"攻击+5",need:"30",effect:"status:atk+=5"},{text:"防御+5",need:"30",effect:"status:def+=5"}]}],levelUp:[{},{need:20,name:"第二级",effect:"status:hp+=2*(status:atk+status:def);status:atk+=10;status:def+=10"},{need:40,effect:'function () {\r\n\t\t\tcore.insertAction("恭喜升级！");\r\n\t\t\tcore.status.hero.hp *= 2;\r\n\t\t\tcore.status.hero.atk += 100;\r\n\t\t\tcore.status.hero.def += 100;\r\n\t\t}'}]},values:{lavaDamage:100,poisonDamage:10,weakValue:20,redJewel:3,blueJewel:3,greenJewel:5,redPotion:100,bluePotion:250,yellowPotion:500,greenPotion:800,moneyPocket:500,breakArmor:0.9,counterAttack:0.1,purify:3,hatred:2,maxValidHp:null,animateSpeed:300},flags:{enableFloor:true,enableName:false,enableLv:false,enableHPMax:false,enableMDef:true,enableMoney:true,enableExperience:false,enableLevelUp:false,enableKeys:true,enablePZF:false,enableDebuff:false,flyNearStair:true,pickaxeFourDirections:false,bombFourDirections:false,snowFourDirections:false,bigKeyIsBox:false,equipment:false,equipboxButton:false,equipPercentage:false,enableAddPoint:false,enableNegativeDamage:false,hatredDecrease:true,betweenAttackCeil:false,useLoop:false,startDirectly:false,canOpenBattleAnimate:true,showBattleAnimateConfirm:false,battleAnimate:false,displayEnemyDamage:true,displayCritical:true,displayExtraDamage:true,enableGentleClick:true,potionWhileRouting:false,enableViewMaps:true,portalWithoutTrigger:true,canGoDeadZone:false,enableMoveDirectly:true,clickMoveDirectly:true}};enemys_fcae963b_31c9_42b4_b48c_bb48d09f3f80={greenSlime:{name:"绿头怪",hp:100,atk:120,def:0,money:1,experience:1,point:0,special:[1,5,7,8]},redSlime:{name:"红头怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:[16,18],value:10},blackSlime:{name:"青头怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},slimelord:{name:"怪王",hp:100,atk:120,def:0,money:10,experience:0,point:0,special:[1,9]},bat:{name:"小蝙蝠",hp:100,atk:120,def:0,money:2,experience:0,point:0,special:1},bigBat:{name:"大蝙蝠",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redBat:{name:"红蝙蝠",hp:100,atk:120,def:0,money:5,experience:0,point:0,special:4},vampire:{name:"冥灵魔王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeleton:{name:"骷髅人",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonSoilder:{name:"骷髅士兵",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonCaptain:{name:"骷髅队长",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},ghostSkeleton:{name:"冥队长",hp:100,atk:120,def:0,money:8,experience:0,point:0,special:7},zombie:{name:"兽人",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},zombieKnight:{name:"兽人武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},rock:{name:"石头人",hp:100,atk:120,def:0,money:4,experience:0,point:0,special:3},slimeMan:{name:"影子战士",hp:100,atk:0,def:0,money:11,experience:0,point:0,special:[10,21],atkValue:2,defValue:3},bluePriest:{name:"初级法师",hp:100,atk:120,def:0,money:3,experience:0,point:1,special:2},redPriest:{name:"高级法师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},brownWizard:{name:"初级巫师",hp:100,atk:120,def:0,money:16,experience:0,point:0,special:15,value:100,range:2},redWizard:{name:"高级巫师",hp:1000,atk:1200,def:0,money:160,experience:0,point:0,special:15,value:200,zoneSquare:true},yellowGuard:{name:"初级卫兵",hp:100,atk:120,def:0,money:10,experience:0,point:0,special:0},blueGuard:{name:"中级卫兵",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redGuard:{name:"高级卫兵",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},swordsman:{name:"双手剑士",hp:100,atk:120,def:0,money:6,experience:0,point:0,special:[5,23]},soldier:{name:"冥战士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},yellowKnight:{name:"金骑士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redKnight:{name:"红骑士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},darkKnight:{name:"黑骑士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},blackKing:{name:"黑衣魔王",hp:1000,atk:500,def:0,money:1000,experience:1000,point:0,special:0,notBomb:true},yellowKing:{name:"黄衣魔王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},greenKing:{name:"青衣武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},blueKnight:{name:"蓝骑士",hp:100,atk:120,def:0,money:9,experience:0,point:0,special:8},goldSlime:{name:"黄头怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonSkeleton:{name:"紫骷髅",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonBat:{name:"紫蝙蝠",hp:100,atk:120,def:0,money:14,experience:0,point:0,special:13},steelRock:{name:"铁面人",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonPriest:{name:"骷髅法师",hp:100,atk:100,def:0,money:0,experience:0,point:0,special:18,value:20},skeletonKing:{name:"骷髅王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonWizard:{name:"骷髅巫师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redSkeletonCaption:{name:"骷髅武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badHero:{name:"迷失勇者",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},demon:{name:"魔神武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},demonPriest:{name:"魔神法师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},goldHornSlime:{name:"金角怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redKing:{name:"红衣魔王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},whiteKing:{name:"白衣武士",hp:100,atk:120,def:0,money:17,experience:0,point:0,special:16},blackMagician:{name:"黑暗大法师",hp:100,atk:120,def:0,money:12,experience:0,point:0,special:11,value:0.3333333333333333,add:true,notBomb:true},silverSlime:{name:"银头怪",hp:100,atk:120,def:0,money:15,experience:0,point:0,special:14},swordEmperor:{name:"剑圣",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},whiteHornSlime:{name:"尖角怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badPrincess:{name:"痛苦魔女",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badFairy:{name:"黑暗仙子",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},grayPriest:{name:"中级法师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redSwordsman:{name:"剑王",hp:100,atk:120,def:0,money:7,experience:0,point:0,special:6,n:8},whiteGhost:{name:"水银战士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonZombie:{name:"绿兽人",hp:100,atk:120,def:0,money:13,experience:0,point:0,special:12},magicDragon:{name:"魔龙",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},octopus:{name:"血影",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},darkFairy:{name:"仙子",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},greenKnight:{name:"强盾骑士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},angel:{name:"天使",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},elemental:{name:"元素生物",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},steelGuard:{name:"铁守卫",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:18,value:20},evilBat:{name:"邪恶蝙蝠",hp:1000,atk:1,def:0,money:0,experience:0,point:0,special:[2,3]}};icons_4665ee12_3a1f_44a4_bea3_0fccba634dc1={hero:{down:{loc:0,stop:0,leftFoot:1,rightFoot:3},left:{loc:1,stop:0,leftFoot:1,rightFoot:3},right:{loc:2,stop:0,leftFoot:1,rightFoot:3},up:{loc:3,stop:0,leftFoot:1,rightFoot:3}},terrains:{ground:0,grass:1,grass2:2,yellowWall:3,whiteWall:4,blueWall:5,snowGround:6,ground2:7,ground3:8,ground4:9,sand:10,ground5:11,yellowWall2:12,whiteWall2:13,blueWall2:14,blockWall:15,grayWall:16,white:17,ground6:18,soil:19,ground7:20,ground8:21,ice:22,downFloor:23,upFloor:24,yellowDoor:25,blueDoor:26,redDoor:27,greenDoor:28,specialDoor:29,steelDoor:30,"blueShop-left":31,"blueShop-right":32,"pinkShop-left":33,"pinkShop-right":34,arrowUp:35,arrowDown:36,arrowLeft:37,arrowRight:38,light:39,darkLight:40,ski:41,flower:42,box:43,boxed:44},animates:{star:0,lava:1,blueWater:2,water:3,yellowDoor:4,blueDoor:5,redDoor:6,greenDoor:7,specialDoor:8,steelDoor:9,yellowWallDoor:10,whiteWallDoor:11,blueWallDoor:12,lavaDoor:13,starDoor:14,starPortal:15,fire:16,portal:17,"switch":18,lavaNet:19,poisonNet:20,weakNet:21,curseNet:22,downPortal:23,leftPortal:24,rightPortal:25,upPortal:26,},npcs:{man:0,woman:1,thief:2,fairy:3,magician:4,womanMagician:5,oldMan:6,child:7,wood:8,pinkShop:9,blueShop:10,princess:11,wlt:12,wt:13,wrt:14,wl:15,wc:16,wr:17,wlb:18,wrb:19,dlt:20,dt:21,drt:22,dl:23,dc:24,dr:25,dlb:26,drb:27,},npc48:{npc0:0,npc1:1,npc2:2,npc3:3,npc4:4,},enemys:{greenSlime:0,redSlime:1,blackSlime:2,slimelord:3,bat:4,bigBat:5,redBat:6,vampire:7,skeleton:8,skeletonSoilder:9,skeletonCaptain:10,ghostSkeleton:11,zombie:12,zombieKnight:13,rock:14,slimeMan:15,bluePriest:16,redPriest:17,brownWizard:18,redWizard:19,yellowGuard:20,blueGuard:21,redGuard:22,swordsman:23,soldier:24,yellowKnight:25,redKnight:26,darkKnight:27,blackKing:28,yellowKing:29,greenKing:30,blueKnight:31,goldSlime:32,poisonSkeleton:33,poisonBat:34,steelRock:35,skeletonPriest:36,skeletonKing:37,skeletonWizard:38,redSkeletonCaption:39,badHero:40,demon:41,demonPriest:42,goldHornSlime:43,redKing:44,whiteKing:45,blackMagician:46,silverSlime:47,swordEmperor:48,whiteHornSlime:49,badPrincess:50,badFairy:51,grayPriest:52,redSwordsman:53,whiteGhost:54,poisonZombie:55,magicDragon:56,octopus:57,darkFairy:58,greenKnight:59,},enemy48:{angel:0,elemental:1,steelGuard:2,evilBat:3,},items:{yellowKey:0,blueKey:1,redKey:2,greenKey:3,steelKey:4,bigKey:6,redJewel:16,blueJewel:17,greenJewel:18,yellowJewel:19,redPotion:20,bluePotion:21,greenPotion:22,yellowPotion:23,lifeWand:33,sword0:60,sword1:50,sword2:51,sword3:52,sword4:53,sword5:54,shield0:61,shield1:55,shield2:56,shield3:57,shield4:58,shield5:59,book:9,fly:12,pickaxe:45,icePickaxe:44,bomb:43,centerFly:13,upFly:15,downFly:14,coin:11,snow:41,cross:40,superPotion:29,earthquake:8,poisonWine:24,weakWine:25,curseWine:27,superWine:28,knife:42,moneyPocket:46,shoes:47,hammer:48,jumpShoes:49},autotile:{autotile:0,autotile1:0,autotile2:0,autotile3:0,}};maps_90f36752_8815_4be8_b32b_d7fad1d0542e={"1":{cls:"terrains",id:"yellowWall"},"2":{cls:"terrains",id:"whiteWall"},"3":{cls:"terrains",id:"blueWall"},"4":{cls:"animates",id:"star",noPass:true},"5":{cls:"animates",id:"lava",noPass:true},"6":{cls:"terrains",id:"ice"},"7":{cls:"terrains",id:"blueShop-left"},"8":{cls:"terrains",id:"blueShop-right"},"9":{cls:"terrains",id:"pinkShop-left"},"10":{cls:"terrains",id:"pinkShop-right"},"11":{cls:"animates",id:"lavaNet",noPass:false,trigger:"passNet"},"12":{cls:"animates",id:"poisonNet",noPass:false,trigger:"passNet"},"13":{cls:"animates",id:"weakNet",noPass:false,trigger:"passNet"},"14":{cls:"animates",id:"curseNet",noPass:false,trigger:"passNet"},"15":{cls:"animates",id:"blueWater",noPass:true},"16":{cls:"animates",id:"water",noPass:true},"20":{cls:"autotile",id:"autotile",noPass:true},"21":{cls:"items",id:"yellowKey"},"22":{cls:"items",id:"blueKey"},"23":{cls:"items",id:"redKey"},"24":{cls:"items",id:"greenKey"},"25":{cls:"items",id:"steelKey"},"26":{cls:"items",id:"bigKey"},"27":{cls:"items",id:"redJewel"},"28":{cls:"items",id:"blueJewel"},"29":{cls:"items",id:"greenJewel"},"30":{cls:"items",id:"yellowJewel"},"31":{cls:"items",id:"redPotion"},"32":{cls:"items",id:"bluePotion"},"33":{cls:"items",id:"greenPotion"},"34":{cls:"items",id:"yellowPotion"},"35":{cls:"items",id:"sword1"},"36":{cls:"items",id:"shield1"},"37":{cls:"items",id:"sword2"},"38":{cls:"items",id:"shield2"},"39":{cls:"items",id:"sword3"},"40":{cls:"items",id:"shield3"},"41":{cls:"items",id:"sword4"},"42":{cls:"items",id:"shield4"},"43":{cls:"items",id:"sword5"},"44":{cls:"items",id:"shield5"},"45":{cls:"items",id:"book"},"46":{cls:"items",id:"fly"},"47":{cls:"items",id:"pickaxe"},"48":{cls:"items",id:"icePickaxe"},"49":{cls:"items",id:"bomb"},"50":{cls:"items",id:"centerFly"},"51":{cls:"items",id:"upFly"},"52":{cls:"items",id:"downFly"},"53":{cls:"items",id:"coin"},"54":{cls:"items",id:"snow"},"55":{cls:"items",id:"cross"},"56":{cls:"items",id:"superPotion"},"57":{cls:"items",id:"earthquake"},"58":{cls:"items",id:"poisonWine"},"59":{cls:"items",id:"weakWine"},"60":{cls:"items",id:"curseWine"},"61":{cls:"items",id:"superWine"},"62":{cls:"items",id:"knife"},"63":{cls:"items",id:"moneyPocket"},"64":{cls:"items",id:"shoes"},"65":{cls:"items",id:"hammer"},"68":{cls:"items",id:"lifeWand"},"69":{cls:"items",id:"jumpShoes"},"81":{cls:"terrains",id:"yellowDoor",trigger:"openDoor"},"82":{cls:"terrains",id:"blueDoor",trigger:"openDoor"},"83":{cls:"terrains",id:"redDoor",trigger:"openDoor"},"84":{cls:"terrains",id:"greenDoor",trigger:"openDoor"},"85":{cls:"terrains",id:"specialDoor",trigger:"openDoor"},"86":{cls:"terrains",id:"steelDoor",trigger:"openDoor"},"87":{cls:"terrains",id:"upFloor",noPass:false},"88":{cls:"terrains",id:"downFloor",noPass:false},"89":{cls:"animates",id:"portal",noPass:false},"90":{cls:"animates",id:"starPortal",noPass:false},"91":{cls:"animates",id:"upPortal",noPass:false},"92":{cls:"animates",id:"leftPortal",noPass:false},"93":{cls:"animates",id:"downPortal",noPass:false},"94":{cls:"animates",id:"rightPortal",noPass:false},"121":{cls:"npcs",id:"man"},"122":{cls:"npcs",id:"woman",noPass:true},"123":{cls:"npcs",id:"thief"},"124":{cls:"npcs",id:"fairy"},"125":{cls:"npcs",id:"magician"},"126":{cls:"npcs",id:"womanMagician"},"127":{cls:"npcs",id:"oldMan"},"128":{cls:"npcs",id:"child"},"129":{cls:"npcs",id:"wood"},"130":{cls:"npcs",id:"pinkShop"},"131":{cls:"npcs",id:"blueShop"},"132":{cls:"npcs",id:"princess"},"133":{cls:"npc48",id:"npc0"},"134":{cls:"npc48",id:"npc1"},"135":{cls:"npc48",id:"npc2"},"136":{cls:"npc48",id:"npc3"},"137":{cls:"npc48",id:"npc4"},"151":{cls:"autotile",id:"autotile1",noPass:true},"152":{cls:"autotile",id:"autotile2",noPass:true},"153":{cls:"autotile",id:"autotile3",noPass:true},"161":{cls:"terrains",id:"arrowUp",noPass:false},"162":{cls:"terrains",id:"arrowDown",noPass:false},"163":{cls:"terrains",id:"arrowLeft",noPass:false},"164":{cls:"terrains",id:"arrowRight",noPass:false},"165":{cls:"terrains",id:"light",trigger:"changeLight",noPass:false},"166":{cls:"terrains",id:"darkLight",noPass:true},"167":{cls:"terrains",id:"ski",trigger:"ski",noPass:false},"168":{cls:"terrains",id:"flower",noPass:false},"169":{cls:"terrains",id:"box",trigger:"pushBox",noPass:true},"170":{cls:"terrains",id:"boxed",trigger:"pushBox",noPass:true},"181":{cls:"npcs",id:"wlt"},"182":{cls:"npcs",id:"wt"},"183":{cls:"npcs",id:"wrt"},"184":{cls:"npcs",id:"wl"},"185":{cls:"npcs",id:"wc"},"186":{cls:"npcs",id:"wr"},"187":{cls:"npcs",id:"wlb"},"188":{cls:"npcs",id:"wrb"},"189":{cls:"npcs",id:"dlt"},"190":{cls:"npcs",id:"dt"},"191":{cls:"npcs",id:"drt"},"192":{cls:"npcs",id:"dl"},"193":{cls:"npcs",id:"dc"},"194":{cls:"npcs",id:"dr"},"195":{cls:"npcs",id:"dlb"},"196":{cls:"npcs",id:"drb"},"201":{cls:"enemys",id:"greenSlime"},"202":{cls:"enemys",id:"redSlime"},"203":{cls:"enemys",id:"blackSlime"},"204":{cls:"enemys",id:"slimelord"},"205":{cls:"enemys",id:"bat"},"206":{cls:"enemys",id:"bigBat"},"207":{cls:"enemys",id:"redBat"},"208":{cls:"enemys",id:"vampire"},"209":{cls:"enemys",id:"skeleton"},"210":{cls:"enemys",id:"skeletonSoilder"},"211":{cls:"enemys",id:"skeletonCaptain"},"212":{cls:"enemys",id:"ghostSkeleton"},"213":{cls:"enemys",id:"zombie"},"214":{cls:"enemys",id:"zombieKnight"},"215":{cls:"enemys",id:"rock"},"216":{cls:"enemys",id:"slimeMan"},"217":{cls:"enemys",id:"bluePriest"},"218":{cls:"enemys",id:"redPriest"},"219":{cls:"enemys",id:"brownWizard"},"220":{cls:"enemys",id:"redWizard"},"221":{cls:"enemys",id:"yellowGuard"},"222":{cls:"enemys",id:"blueGuard"},"223":{cls:"enemys",id:"redGuard"},"224":{cls:"enemys",id:"swordsman"},"225":{cls:"enemys",id:"soldier"},"226":{cls:"enemys",id:"yellowKnight"},"227":{cls:"enemys",id:"redKnight"},"228":{cls:"enemys",id:"darkKnight"},"229":{cls:"enemys",id:"blackKing"},"230":{cls:"enemys",id:"yellowKing"},"231":{cls:"enemys",id:"greenKing"},"232":{cls:"enemys",id:"blueKnight"},"233":{cls:"enemys",id:"goldSlime"},"234":{cls:"enemys",id:"poisonSkeleton"},"235":{cls:"enemys",id:"poisonBat"},"236":{cls:"enemys",id:"steelRock"},"237":{cls:"enemys",id:"skeletonPriest"},"238":{cls:"enemys",id:"skeletonKing"},"239":{cls:"enemys",id:"skeletonWizard"},"240":{cls:"enemys",id:"redSkeletonCaption"},"241":{cls:"enemys",id:"badHero"},"242":{cls:"enemys",id:"demon"},"243":{cls:"enemys",id:"demonPriest"},"244":{cls:"enemys",id:"goldHornSlime"},"245":{cls:"enemys",id:"redKing"},"246":{cls:"enemys",id:"whiteKing"},"247":{cls:"enemys",id:"blackMagician"},"248":{cls:"enemys",id:"silverSlime"},"249":{cls:"enemys",id:"swordEmperor"},"250":{cls:"enemys",id:"whiteHornSlime"},"251":{cls:"enemys",id:"badPrincess"},"252":{cls:"enemys",id:"badFairy"},"253":{cls:"enemys",id:"grayPriest"},"254":{cls:"enemys",id:"redSwordsman"},"255":{cls:"enemys",id:"whiteGhost"},"256":{cls:"enemys",id:"poisonZombie"},"257":{cls:"enemys",id:"magicDragon"},"258":{cls:"enemys",id:"octopus"},"259":{cls:"enemys",id:"darkFairy"},"260":{cls:"enemys",id:"greenKnight"},"261":{cls:"enemy48",id:"angel"},"262":{cls:"enemy48",id:"elemental"},"263":{cls:"enemy48",id:"steelGuard"},"264":{cls:"enemy48",id:"evilBat"}};items_296f5d02_12fd_4166_a7c1_b5e830c9ee3a={items:{yellowKey:{cls:"keys",name:"黄钥匙"},blueKey:{cls:"keys",name:"蓝钥匙"},redKey:{cls:"keys",name:"红钥匙"},redJewel:{cls:"items",name:"红宝石"},blueJewel:{cls:"items",name:"蓝宝石"},greenJewel:{cls:"items",name:"绿宝石"},yellowJewel:{cls:"items",name:"黄宝石"},redPotion:{cls:"items",name:"红血瓶"},bluePotion:{cls:"items",name:"蓝血瓶"},yellowPotion:{cls:"items",name:"黄血瓶"},greenPotion:{cls:"items",name:"绿血瓶"},sword0:{cls:"items",name:"破旧的剑",text:"一把已经生锈的剑",equip:{type:0,atk:0,animate:"sword"}},sword1:{cls:"items",name:"铁剑",text:"好胜之剑",equip:{type:0,atk:10,animate:"sword"}},sword2:{cls:"items",name:"银剑",text:"一把很普通的银剑",equip:{type:0,atk:20,animate:"sword"}},sword3:{cls:"items",name:"骑士剑",text:"一把很普通的骑士剑",equip:{type:0,atk:40,animate:"sword"}},sword4:{cls:"items",name:"圣剑",text:"一把很普通的圣剑",equip:{type:0,atk:80,animate:"sword"}},sword5:{cls:"items",name:"神圣剑",text:"一把很普通的神圣剑",equip:{type:0,atk:100,animate:"sword"}},shield0:{cls:"items",name:"破旧的盾",text:"一个很破旧的铁盾",equip:{type:1,def:0}},shield1:{cls:"items",name:"铁盾",text:"自信之盾",equip:{type:1,def:10}},shield2:{cls:"items",name:"银盾",text:"一个很普通的银盾",equip:{type:1,def:20}},shield3:{cls:"items",name:"骑士盾",text:"一个很普通的骑士盾",equip:{type:1,def:40}},shield4:{cls:"items",name:"圣盾",text:"一个很普通的圣盾",equip:{type:1,def:80}},shield5:{cls:"items",name:"神圣盾",text:"一个很普通的神圣盾",equip:{type:1,def:100,mdef:100}},superPotion:{cls:"items",name:"圣水"},moneyPocket:{cls:"items",name:"金钱袋"},book:{cls:"constants",name:"怪物手册",text:"可以查看当前楼层各怪物属性"},fly:{cls:"constants",name:"楼层传送器",text:"可以自由往来去过的楼层"},coin:{cls:"constants",name:"幸运金币",text:"持有时打败怪物可得双倍金币"},snow:{cls:"constants",name:"冰冻徽章",text:"可以将面前的熔岩变成平地"},cross:{cls:"constants",name:"十字架",text:"持有后无视怪物的无敌属性"},knife:{cls:"constants",name:"屠龙匕首",text:"该道具尚未被定义"},shoes:{cls:"constants",name:"绿鞋",text:"持有时无视负面地形"},bigKey:{cls:"tools",name:"大黄门钥匙",text:"可以开启当前层所有黄门"},greenKey:{cls:"tools",name:"绿钥匙",text:"可以打开一扇绿门"},steelKey:{cls:"tools",name:"铁门钥匙",text:"可以打开一扇铁门"},pickaxe:{cls:"tools",name:"破墙镐",text:"可以破坏勇士面前的墙"},icePickaxe:{cls:"tools",name:"破冰镐",text:"可以破坏勇士面前的一堵冰墙"},bomb:{cls:"tools",name:"炸弹",text:"可以炸掉勇士面前的怪物"},centerFly:{cls:"tools",name:"中心对称飞行器",text:"可以飞向当前楼层中心对称的位置"},upFly:{cls:"tools",name:"上楼器",text:"可以飞往楼上的相同位置"},downFly:{cls:"tools",name:"下楼器",text:"可以飞往楼下的相同位置"},earthquake:{cls:"tools",name:"地震卷轴",text:"可以破坏当前层的所有墙"},poisonWine:{cls:"tools",name:"解毒药水",text:"可以解除中毒状态"},weakWine:{cls:"tools",name:"解衰药水",text:"可以解除衰弱状态"},curseWine:{cls:"tools",name:"解咒药水",text:"可以解除诅咒状态"},superWine:{cls:"tools",name:"万能药水",text:"可以解除所有不良状态"},hammer:{cls:"tools",name:"圣锤",text:"可以炸掉勇士面前的怪物"},lifeWand:{cls:"tools",name:"生命魔杖",text:"可以恢复100点生命值"},jumpShoes:{cls:"tools",name:"跳跃靴",text:"能跳跃到前方两格处"}},itemEffect:{redJewel:"core.status.hero.atk += core.values.redJewel * ratio",blueJewel:"core.status.hero.def += core.values.blueJewel * ratio",greenJewel:"core.status.hero.mdef += core.values.greenJewel * ratio",yellowJewel:"core.status.hero.hp+=1000;core.status.hero.atk+=6;core.status.hero.def+=6;core.status.hero.mdef+=10;",redPotion:"core.status.hero.hp += core.values.redPotion * ratio",bluePotion:"core.status.hero.hp += core.values.bluePotion * ratio",yellowPotion:"core.status.hero.hp += core.values.yellowPotion * ratio",greenPotion:"core.status.hero.hp += core.values.greenPotion * ratio",sword0:"core.status.hero.atk += 0",sword1:"core.status.hero.atk += 10",sword2:"core.status.hero.atk += 20",sword3:"core.status.hero.atk += 40",sword4:"core.status.hero.atk += 80",sword5:"core.status.hero.atk += 100",shield0:"core.status.hero.def += 0",shield1:"core.status.hero.def += 10",shield2:"core.status.hero.def += 20",shield3:"core.status.hero.def += 40",shield4:"core.status.hero.def += 80",shield5:"core.status.hero.def += 100;core.status.hero.mdef += 100",bigKey:"core.status.hero.items.keys.yellowKey++;core.status.hero.items.keys.blueKey++;core.status.hero.items.keys.redKey++;",superPotion:"core.status.hero.hp *= 2",moneyPocket:"core.status.hero.money += core.values.moneyPocket"},itemEffectTip:{redJewel:"'，攻击+'+core.values.redJewel * ratio",blueJewel:"'，防御+'+core.values.blueJewel * ratio",greenJewel:"'，魔防+'+core.values.greenJewel * ratio",yellowJewel:"'，全属性提升'",redPotion:"'，生命+'+core.values.redPotion * ratio",bluePotion:"'，生命+'+core.values.bluePotion * ratio",yellowPotion:"'，生命+'+core.values.yellowPotion * ratio",greenPotion:"'，生命+'+core.values.greenPotion * ratio",sword0:"'，攻击+0'",sword1:"'，攻击+10'",sword2:"'，攻击+20'",sword3:"'，攻击+40'",sword4:"'，攻击+80'",sword5:"'，攻击+100'",shield0:"'，防御+0'",shield1:"'，防御+10'",shield2:"'，防御+20'",shield3:"'，防御+40'",shield4:"'，防御+80'",shield5:"'，防御+100，魔防+100'",bigKey:"'，全钥匙+1'",superPotion:"'，生命值翻倍'",moneyPocket:"'，金币+'+core.values.moneyPocket"},useItemEffect:{book:"core.ui.drawBook(0);",fly:"core.ui.drawFly(core.status.hero.flyRange.indexOf(core.status.floorId));",earthquake:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n});",pickaxe:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n});",icePickaxe:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n});",snow:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n});",bigKey:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n});",bomb:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n    core.events.afterUseBomb();\n});",hammer:"core.removeBlockByIds(core.status.floorId, core.status.event.data);\ncore.drawMap(core.status.floorId, function () {\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n    core.events.afterUseBomb();\n});",centerFly:"core.clearMap('hero');\ncore.setHeroLoc('x', (core.bigmap.width||13)-1-core.getHeroLoc('x'));\ncore.setHeroLoc('y', (core.bigmap.height||13)-1-core.getHeroLoc('y'));\ncore.drawHero();\ncore.drawTip(core.material.items[itemId].name + '使用成功');",upFly:"var loc = {'direction': core.status.hero.loc.direction, 'x': core.status.event.data.x, 'y': core.status.event.data.y};\ncore.changeFloor(core.status.event.data.id, null, loc, null, function (){\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n    core.replay();\n});",downFly:"var loc = {'direction': core.status.hero.loc.direction, 'x': core.status.event.data.x, 'y': core.status.event.data.y};\ncore.changeFloor(core.status.event.data.id, null, loc, null, function (){\n    core.drawTip(core.material.items[itemId].name + '使用成功');\n    core.replay();\n});",poisonWine:"core.setFlag('poison', false);",weakWine:"core.setFlag('weak', false);\ncore.status.hero.atk += core.getFlag('weakAtk', core.values.weakValue);\ncore.status.hero.def += core.getFlag('weakDef', core.values.weakValue);",curseWine:"core.setFlag('curse', false);",superWine:"core.setFlag('poison', false);\nif (core.hasFlag('weak')) {\n    core.setFlag('weak', false);\n    core.status.hero.atk += core.getFlag('weakAtk', core.values.weakValue);\n    core.status.hero.def += core.getFlag('weakDef', core.values.weakValue);\n}\ncore.setFlag('curse', false);",lifeWand:'core.insertAction([\n\t{"type": "input", "text": "请输入生命魔杖使用次数：(0-${item:lifeWand})"},\n\t{"type": "if", "condition": "flag:input<=item:lifeWand",\n\t\t"true": [\n\t\t\t{"type": "setValue", "name": "item:lifeWand", "value": "item:lifeWand-flag:input"},\n\t\t\t{"type": "setValue", "name": "status:hp", "value": "status:hp+flag:input*100"},\n\t\t\t"成功使用${flag:input}次生命魔杖，恢复${flag:input*100}点生命。"\n\t\t],\n\t\t"false": ["输入不合法！"]\n\t},\n]);\ncore.setItem(\'lifeWand\', core.itemCount(\'lifeWand\')+1);',jumpShoes:'core.insertAction({"type":"jumpHero","loc":[core.nextX(2),core.nextY(2)]});'},canUseItemEffect:{book:"true",fly:"core.status.hero.flyRange.indexOf(core.status.floorId)>=0",pickaxe:"var able=false;\nvar ids = [], id2s = [];\nfor (var i in core.status.thisMap.blocks) {\n\tvar block = core.status.thisMap.blocks[i];\n\tif (core.isset(block.event) && !block.disable && Math.abs(block.x-core.status.hero.loc.x)+Math.abs(block.y-core.status.hero.loc.y)<=1\n\t\t&& (block.event.id == 'yellowWall' || block.event.id=='whiteWall' || block.event.id=='blueWall')) // 能破哪些墙\n\t{\n\t\t// 四个方向\n\t\tif (core.flags.pickaxeFourDirections || (block.x == core.nextX() && block.y == core.nextY()))\n\t\t\tids.push(i);\n\t\telse id2s.push(i);\n\t}\n}\nif (ids.length>0) {\n\tcore.status.event.data = ids;\n\table=true;\n}\nelse if (id2s.length==1) {\n\tcore.status.event.data = id2s;\n\table=true;\n}\nable",icePickaxe:"var able=false;\nfor (var i in core.status.thisMap.blocks) {\n\tvar block = core.status.thisMap.blocks[i];\n\tif (core.isset(block.event) && !block.disable && block.x==core.nextX() && block.y==core.nextY() && block.event.id=='ice') {\n\t\tcore.status.event.data = [i];\n\t\table=true;\n\t}\n}\nable",bomb:"var able=false;\nvar ids = [], id2s = [];\nfor (var i in core.status.thisMap.blocks) {\n\tvar block = core.status.thisMap.blocks[i];\n\tif (core.isset(block.event) && !block.disable && block.event.cls.indexOf('enemy')==0 && Math.abs(block.x-core.status.hero.loc.x)+Math.abs(block.y-core.status.hero.loc.y)<=1) {\n\t\tvar enemy = core.material.enemys[block.event.id];\n\t\tif (core.isset(enemy) && enemy.notBomb) continue;\n\t\tif (core.flags.bombFourDirections || (block.x==core.nextX() && block.y==core.nextY()))\n\t\t\tids.push(i);\n\t\telse\n\t\t\tid2s.push(i);\n\t}\n}\nif (ids.length>0) {\n\tcore.status.event.data = ids;\n\table=true;\n}\nelse if (id2s.length==1) {\n\tcore.status.event.data = id2s;\n\table=true;\n}\nable",hammer:"var able=false;\nvar ids = [], id2s = [];\nfor (var i in core.status.thisMap.blocks) {\n\tvar block = core.status.thisMap.blocks[i];\n\tif (core.isset(block.event) && !block.disable && block.event.cls.indexOf('enemy')==0 && \n\t\tMath.abs(block.x-core.status.hero.loc.x)+Math.abs(block.y-core.status.hero.loc.y)<=1) {\n\t\tvar enemy = core.material.enemys[block.event.id];\n\t\tif (core.isset(enemy) && enemy.notBomb) continue;\n\t\tif (block.x==core.nextX() && block.y==core.nextY())\n\t\t\tids.push(i);\n\t\telse\n\t\t\tid2s.push(i);\n\t}\n}\nif (ids.length>0) {\n\tcore.status.event.data = ids;\n\table=true;\n}\nelse if (id2s.length==1) {\n\tcore.status.event.data = id2s;\n\table=true;\n}\nable",earthquake:"var able=false;\nvar ids = [];\nfor (var i in core.status.thisMap.blocks) {\n    var block = core.status.thisMap.blocks[i];\n    if (core.isset(block.event) && !block.disable && (block.event.id == 'yellowWall' || block.event.id == 'blueWall' || block.event.id == 'whiteWall')) // 能炸的墙壁\n        ids.push(i);\n}\nif (ids.length>0) {\n    core.status.event.data = ids;\n    able=true;\n}\nable",centerFly:"var toX = (core.bigmap.width||13)-1-core.getHeroLoc('x'), toY = (core.bigmap.height||13)-1-core.getHeroLoc('y');\ncore.getBlockId(toX, toY) == null",upFly:"var able=false;\nvar floorId = core.status.floorId, index = core.floorIds.indexOf(floorId);\nif (index<core.floorIds.length-1) {\n\tvar toId = core.floorIds[index+1], toX = core.getHeroLoc('x'), toY = core.getHeroLoc('y');\n\tvar mw = core.floors[toId].width||13, mh = core.floors[toId].height||13;\n\tif (toX>=0 && toX<mw && toY>=0 && toY<mh && core.getBlock(toX, toY, toId)==null) {\n\t\tcore.status.event.data = {'id': toId, 'x': toX, 'y': toY};\n\t\table=true;\n\t}\n}\nable",downFly:"var able=false;\nvar floorId = core.status.floorId, index = core.floorIds.indexOf(floorId);\nif (index>0) {\n\tvar toId = core.floorIds[index-1], toX = core.getHeroLoc('x'), toY = core.getHeroLoc('y');\n\tvar mw = core.floors[toId].width||13, mh = core.floors[toId].height||13;\n\tif (toX>=0 && toX<mw && toY>=0 && toY<mh && core.getBlock(toX, toY, toId)==null) {\n\t\tcore.status.event.data = {'id': toId, 'x': toX, 'y': toY};\n\t\table=true;\n\t}\n}\nable",snow:"var able=false;\nvar ids = [], id2s = [];\nfor (var i in core.status.thisMap.blocks) {\n\tvar block = core.status.thisMap.blocks[i];\n\tif (core.isset(block.event) && !block.disable && block.event.id == 'lava' && Math.abs(block.x-core.status.hero.loc.x)+Math.abs(block.y-core.status.hero.loc.y)<=1) {\n\t\tif (core.flags.snowFourDirections || (block.x == core.nextX() && block.y == core.nextY()))\n\t\t\tids.push(i);\n\t\telse id2s.push(i);\n\t}\n}\nif (ids.length>0) {\n\tcore.status.event.data = ids;\n\table=true;\n}\nelse if (id2s.length==1) {\n\tcore.status.event.data = id2s;\n\table=true;\n}\nable",bigKey:"var able=false;\nvar ids = [];\nfor (var i in core.status.thisMap.blocks) {\n    var block = core.status.thisMap.blocks[i];\n    if (core.isset(block.event) && !block.disable && block.event.id == 'yellowDoor') {\n        ids.push(i);\n    }\n}\nif (ids.length>0) {\n    core.status.event.data = ids;\n    able=true;\n}\nable",poisonWine:"core.hasFlag('poison')",weakWine:"core.hasFlag('weak')",curseWine:"core.hasFlag('curse')",superWine:"core.hasFlag('poison') || core.hasFlag('weak') || core.hasFlag('curse')",lifeWand:"true",jumpShoes:"var nx=core.nextX(2),ny=core.nextY(2);nx>=0&&nx<core.bigmap.width&&ny>=0&&ny<core.bigmap.height&&core.getBlock(nx,ny)==null"}};functions_d6ad677b_427a_4623_b50f_a445a3b0ef8a={events:{initGame:function(){if(core.flags.bigKeyIsBox){core.material.items.bigKey={cls:"items",name:"钥匙盒"}}if(core.flags.pickaxeFourDirections){core.material.items.pickaxe.text="可以破坏勇士四周的墙"}if(core.flags.bombFourDirections){core.material.items.bomb.text="可以炸掉勇士四周的怪物"}if(core.flags.snowFourDirections){core.material.items.bomb.text="可以将四周的熔岩变成平地"}if(core.flags.equipboxButton){core.statusBar.image.fly.src=core.statusBar.icons.equipbox.src;core.flags.equipment=true}if(core.flags.equipment){core.material.items.sword1.cls="equips";core.material.items.sword2.cls="equips";core.material.items.sword3.cls="equips";core.material.items.sword4.cls="equips";core.material.items.sword5.cls="equips";core.material.items.shield1.cls="equips";core.material.items.shield2.cls="equips";core.material.items.shield3.cls="equips";core.material.items.shield4.cls="equips";core.material.items.shield5.cls="equips"}},setInitData:function(a){if(a=="Easy"){core.setFlag("hard",1)}if(a=="Normal"){core.setFlag("hard",2)}if(a=="Hard"){core.setFlag("hard",3)}if(a=="Hell"){core.setFlag("hard",4)}core.events.afterLoadData()},win:function(b,a){core.ui.closePanel();var c=core.status.replay.replaying;core.stopReplay();core.waitHeroToStop(function(){core.removeGlobalAnimate(0,0,true);core.clearMap("all");core.drawText(["\t["+(b||"恭喜通关")+"]你的分数是${status:hp}。"],function(){core.events.gameOver(b||"",c,a)})})},lose:function(a){core.ui.closePanel();var b=core.status.replay.replaying;core.stopReplay();core.waitHeroToStop(function(){core.drawText(["\t["+(a||"结局1")+"]你死了。\n如题。"],function(){core.events.gameOver(null,b)})})},afterChangeFloor:function(a,b){if(!core.hasFlag("visited_"+a)){core.insertAction(core.floors[a].firstArrive);core.setFlag("visited_"+a,true)}},addPoint:function(a){var b=a.point;if(!core.flags.enableAddPoint||!core.isset(b)||b<=0){return[]}return[{type:"choices",choices:[{text:"攻击+"+(1*b),action:[{type:"setValue",name:"status:atk",value:"status:atk+"+(1*b)}]},{text:"防御+"+(2*b),action:[{type:"setValue",name:"status:def",value:"status:def+"+(2*b)}]},{text:"生命+"+(200*b),action:[{type:"setValue",name:"status:hp",value:"status:hp+"+(200*b)}]},]}]},afterBattle:function(d,q,r,a){var c=core.material.enemys[d];var e="hand";if(core.flags.equipment){var f=(core.status.hero.equipment||[])[0];if(core.isset(core.material.items[f])&&core.isset(core.material.items[f].equip.animate)){e=core.material.items[f].equip.animate}}core.playSound("attack.mp3");core.drawAnimate(e,q,r);var b=core.enemys.getDamage(d,q,r);if(b==null){b=core.status.hero.hp+1}core.status.hero.hp-=b;core.status.hero.statistics.battleDamage+=b;core.status.hero.statistics.battle++;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose("战斗失败");return}var j=c.money;if(core.hasItem("coin")){j*=2}if(core.hasFlag("curse")){j=0}core.status.hero.money+=j;var h=c.experience;if(core.hasFlag("curse")){h=0}core.status.hero.experience+=h;var i="打败 "+c.name;if(core.flags.enableMoney){i+="，金币+"+j}if(core.flags.enableExperience){i+="，经验+"+h}core.drawTip(i);if(core.isset(q)&&core.isset(r)){core.removeBlock(q,r)}var l=c.special;if(core.enemys.hasSpecial(l,12)&&!core.hasFlag("poison")){core.setFlag("poison",true)}if(core.enemys.hasSpecial(l,13)&&!core.hasFlag("weak")){core.setFlag("weak",true);var p=core.values.weakValue;var n=p>=1?p:Math.floor(p*core.status.hero.atk);var o=p>=1?p:Math.floor(p*core.status.hero.def);core.setFlag("weakAtk",n);core.setFlag("weakDef",o);core.status.hero.atk-=n;core.status.hero.def-=o}if(core.enemys.hasSpecial(l,14)&&!core.hasFlag("curse")){core.setFlag("curse",true)}if(core.flags.hatredDecrease&&core.enemys.hasSpecial(l,17)){core.setFlag("hatred",parseInt(core.getFlag("hatred",0)/2))}if(core.enemys.hasSpecial(l,19)){core.status.hero.hp=1}if(core.enemys.hasSpecial(l,21)){core.status.hero.atk-=(c.atkValue||0);core.status.hero.def-=(c.defValue||0);if(core.status.hero.atk<0){core.status.hero.atk=0}if(core.status.hero.def<0){core.status.hero.def=0}}core.setFlag("hatred",core.getFlag("hatred",0)+core.values.hatred);core.updateStatusBar();var m=[];if(!core.enemys.hasSpecial(l,18)&&core.isset(q)&&core.isset(r)){var g=core.floors[core.status.floorId].afterBattle[q+","+r];if(core.isset(g)){core.unshift(m,g)}}var k=core.material.enemys[d].point;if(core.isset(k)&&k>0){core.unshift(m,core.events.addPoint(core.material.enemys[d]))}if(m.length>0){core.events.insertAction(m,q,r)}if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}if(core.isset(a)){a()}},afterOpenDoor:function(b,e,f,a){var d=[];if(core.isset(e)&&core.isset(f)){var c=core.floors[core.status.floorId].afterOpenDoor[e+","+f];if(core.isset(c)){core.unshift(d,c)}}if(d.length>0){core.events.insertAction(d,e,f)}if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}if(core.isset(a)){a()}},afterGetItem:function(c,e,f,a){var d=[];if(core.isset(e)&&core.isset(f)){var b=core.floors[core.status.floorId].afterGetItem[e+","+f];if(core.isset(b)){core.unshift(d,b)}}if(d.length>0){core.events.insertAction(d,e,f)}if(core.isset(a)){a()}},afterChangeLight:function(a,b){},afterPushBox:function(){var a=function(){for(var c=0;c<core.status.thisMap.blocks.length;c++){var b=core.status.thisMap.blocks[c];if(core.isset(b.event)&&b.event.id=="box"){return false}}return true};if(a()){}},afterUseBomb:function(){},beforeSaveData:function(a){},afterLoadData:function(a){core.enemys.updateEnemys()},canUseQuickShop:function(a){if(core.status.thisMap.canUseQuickShop===false){return"当前楼层不能使用快捷商店。"}return null}},enemys:{getSpecials:function(){return[[1,"先攻","怪物首先攻击"],[2,"魔攻","怪物无视勇士的防御"],[3,"坚固","勇士每回合最多只能对怪物造成1点伤害"],[4,"2连击","怪物每回合攻击2次"],[5,"3连击","怪物每回合攻击3次"],[6,function(a){return(a.n||4)+"连击"},function(a){return"怪物每回合攻击"+(a.n||4)+"次"}],[7,"破甲","战斗前，怪物附加角色防御的"+Math.floor(100*core.values.breakArmor||0)+"%作为伤害"],[8,"反击","战斗时，怪物每回合附加角色攻击的"+Math.floor(100*core.values.counterAttack||0)+"%作为伤害，无视角色防御"],[9,"净化","战斗前，怪物附加勇士魔防的"+core.values.purify+"倍作为伤害"],[10,"模仿","怪物的攻防和勇士攻防相等"],[11,"吸血",function(a){return"战斗前，怪物首先吸取角色的"+Math.floor(100*a.value||0)+"%生命（约"+Math.floor((a.value||0)*core.getStatus("hp"))+"点）作为伤害"+(a.add?"，并把伤害数值加到自身生命上":"")}],[12,"中毒","战斗后，勇士陷入中毒状态，每一步损失生命"+core.values.poisonDamage+"点"],[13,"衰弱","战斗后，勇士陷入衰弱状态，攻防暂时下降"+(core.values.weakValue>=1?core.values.weakValue+"点":parseInt(core.values.weakValue*100)+"%")],[14,"诅咒","战斗后，勇士陷入诅咒状态，战斗无法获得金币和经验"],[15,"领域",function(a){return"经过怪物周围"+(a.range||1)+"格时自动减生命"+(a.value||0)+"点"}],[16,"夹击","经过两只相同的怪物中间，勇士生命值变成一半"],[17,"仇恨","战斗前，怪物附加之前积累的仇恨值作为伤害"+(core.flags.hatredDecrease?"；战斗后，释放一半的仇恨值":"")+"。（每杀死一个怪物获得"+(core.values.hatred||0)+"点仇恨值）"],[18,"阻击",function(a){return"经过怪物的十字领域时自动减生命"+(a.value||0)+"点，同时怪物后退一格"}],[19,"自爆","战斗后勇士的生命值变成1"],[20,"无敌","勇士无法打败怪物，除非拥有十字架"],[21,"退化",function(a){return"战斗后勇士永久下降"+(a.atkValue||0)+"点攻击和"+(a.defValue||0)+"点防御"}],[22,"固伤",function(a){return"战斗前，怪物对勇士造成"+(a.damage||0)+"点固定伤害，无视勇士魔防。"}],[23,"重生","怪物被击败后，角色转换楼层则怪物将再次出现"],[24,"激光",function(a){return"经过怪物同行或同列时自动减生命"+(a.value||0)+"点"}],[25,"光环",function(a){return"同楼层所有怪物生命提升"+(a.value||0)+"%，攻击提升"+(a.atkValue||0)+"%，防御提升"+(a.defValue||0)+"%，"+(a.add?"可叠加":"不可叠加")}]]},getEnemyInfo:function(d,h,f,g,i,r,s,e){e=e||core.status.floorId;var n=d.hp,k=d.atk,l=d.def,q=d.special;var o=d.money,m=d.experience,p=d.point;if(this.hasSpecial(q,10)){k=f;l=g}if(this.hasSpecial(q,3)&&l<f-1){l=f-1}var j=0,a=0,c=0,b=0;core.status.maps[e].blocks.forEach(function(t){if(core.isset(t.event)&&!t.disable){var v=t.event.id,u=core.material.enemys[v];if(core.isset(u)&&core.hasSpecial(u.special,25)){if(u.add||b==0){j+=u.value||0;a+=u.atkValue||0;c+=u.defValue||0;b++}}}});n*=(1+j/100);k*=(1+a/100);l*=(1+c/100);return{hp:Math.floor(n),atk:Math.floor(k),def:Math.floor(l),money:Math.floor(o),experience:Math.floor(m),point:Math.floor(p),special:q}},getDamageInfo:function(c,h,f,g,i,s,t,e){e=e||core.status.floorId;h=Math.max(0,h);f=Math.max(0,f);g=Math.max(0,g);i=Math.max(0,i);if(core.flags.equipPercentage){f=Math.floor(core.getFlag("equip_atk_buff",1)*f);g=Math.floor(core.getFlag("equip_def_buff",1)*g);i=Math.floor(core.getFlag("equip_mdef_buff",1)*i)}var d=core.enemys.getEnemyInfo(c,h,f,g,i,s,t,e);var n=d.hp,l=d.atk,m=d.def,o=d.special;if(this.hasSpecial(o,20)&&!core.hasItem("cross")){return null}var k=0;if(this.hasSpecial(o,11)){var r=h*c.value;r=Math.floor(r)||0;if(c.add){n+=r}k+=r}if(f<=m){return null}var p=l-g;if(this.hasSpecial(o,2)){p=l}if(p<0){p=0}if(this.hasSpecial(o,4)){p*=2}if(this.hasSpecial(o,5)){p*=3}if(this.hasSpecial(o,6)){p*=(c.n||4)}var a=0;if(this.hasSpecial(o,8)){a+=Math.floor(core.values.counterAttack*f)}if(this.hasSpecial(o,1)){k+=p}if(this.hasSpecial(o,7)){k+=Math.floor(core.values.breakArmor*g)}if(this.hasSpecial(o,9)){k+=Math.floor(core.values.purify*i)}var j=f-m;var q=Math.ceil(n/j);var b=k+(q-1)*p+q*a;b-=i;if(!core.flags.enableNegativeDamage){b=Math.max(0,b)}return{mon_hp:n,mon_atk:l,mon_def:m,init_damage:k,per_damage:p,hero_per_damage:j,turn:q,damage:b}},updateEnemys:function(){}},control:{flyTo:function(e,a){var b=core.status.floorId;if(!core.status.maps[b].canFlyTo||!core.status.maps[e].canFlyTo){core.drawTip("无法飞往"+core.status.maps[e].title+"！");return false}var c=core.floorIds.indexOf(b),f=core.floorIds.indexOf(e);var d=c<=f?"downFloor":"upFloor";if(c==f&&core.status.maps[b].underGround){d="upFloor"}core.status.route.push("fly:"+e);core.ui.closePanel();core.changeFloor(e,d,null,null,a);return true},updateStatusBar:function(){core.events.checkLvUp();if(core.flags.enableHPMax){core.setStatus("hp",Math.min(core.getStatus("hpmax"),core.getStatus("hp")))}core.events.setFloorName();core.statusBar.name.innerHTML=core.getStatus("name");var b=core.getLvName();core.statusBar.lv.innerHTML=b;if(/^[+-]?\d+$/.test(b)){core.statusBar.lv.style.fontStyle="italic"}else{core.statusBar.lv.style.fontStyle="normal"}var c=["hpmax","hp","atk","def","mdef","money","experience"];c.forEach(function(d){if(core.isset(core.status.hero[d])){core.status.hero[d]=Math.floor(core.status.hero[d])}core.statusBar[d].innerHTML=core.formatBigNumber(core.getStatus(d))});if(core.flags.equipPercentage){core.statusBar.atk.innerHTML=core.formatBigNumber(Math.floor(core.getFlag("equip_atk_buff",1)*core.getStatus("atk")));core.statusBar.def.innerHTML=core.formatBigNumber(Math.floor(core.getFlag("equip_def_buff",1)*core.getStatus("def")));core.statusBar.mdef.innerHTML=core.formatBigNumber(Math.floor(core.getFlag("equip_mdef_buff",1)*core.getStatus("mdef")))}if(core.flags.enableLevelUp&&core.status.hero.lv<core.firstData.levelUp.length){core.statusBar.up.innerHTML=core.firstData.levelUp[core.status.hero.lv].need||"?"}else{core.statusBar.up.innerHTML="?"}var a=["yellowKey","blueKey","redKey"];a.forEach(function(d){core.statusBar[d].innerHTML=core.setTwoDigits(core.status.hero.items.keys[d])});if(core.flags.enableDebuff){core.statusBar.poison.innerHTML=core.hasFlag("poison")?"毒":"";core.statusBar.weak.innerHTML=core.hasFlag("weak")?"衰":"";core.statusBar.curse.innerHTML=core.hasFlag("curse")?"咒":""}if(core.flags.enablePZF){core.statusBar.pickaxe.innerHTML="破"+core.itemCount("pickaxe");core.statusBar.bomb.innerHTML="炸"+core.itemCount("bomb");core.statusBar.fly.innerHTML="飞"+core.itemCount("centerFly")}core.statusBar.hard.innerHTML=core.status.hard;core.updateCheckBlock();core.updateDamage()},updateCheckBlock:function(){core.status.checkBlock={};if(!core.isset(core.status.thisMap)){return}var b=core.status.thisMap.blocks;core.status.checkBlock.map=[];for(var k=0;k<b.length;k++){var a=b[k];if(core.isset(a.event)&&!a.disable&&a.event.cls.indexOf("enemy")==0){var g=a.event.id,e=core.material.enemys[g];if(core.isset(e)){core.status.checkBlock.map[a.x+core.bigmap.width*a.y]=g}}if(core.isset(a.event)&&!a.disable&&a.event.id=="lavaNet"&&a.event.trigger=="passNet"&&!core.hasItem("shoes")){core.status.checkBlock.map[a.x+core.bigmap.width*a.y]="lavaNet"}}core.status.checkBlock.damage=[];for(var p=0;p<core.bigmap.width*core.bigmap.height;p++){core.status.checkBlock.damage[p]=0}for(var p=0;p<core.bigmap.width;p++){for(var q=0;q<core.bigmap.height;q++){var g=core.status.checkBlock.map[p+core.bigmap.width*q];if(core.isset(g)){if(g=="lavaNet"){core.status.checkBlock.damage[p+core.bigmap.width*q]+=core.values.lavaDamage||0;continue}var e=core.material.enemys[g];if(core.enemys.hasSpecial(e.special,15)&&!core.hasFlag("no_zone")){var o=e.range||1;var r=false;if(core.isset(e.zoneSquare)){r=e.zoneSquare}for(var c=-o;c<=o;c++){for(var d=-o;d<=o;d++){if(c==0&&d==0){continue}var l=p+c,m=q+d;if(l<0||l>=core.bigmap.width||m<0||m>=core.bigmap.height){continue}if(!r&&Math.abs(c)+Math.abs(d)>o){continue}core.status.checkBlock.damage[l+m*core.bigmap.width]+=e.value||0}}}if(core.enemys.hasSpecial(e.special,24)&&!core.hasFlag("no_laser")){for(var l=0;l<core.bigmap.width;l++){if(l!=p){core.status.checkBlock.damage[l+q*core.bigmap.width]+=e.value||0}}for(var m=0;m<core.bigmap.height;m++){if(m!=q){core.status.checkBlock.damage[p+m*core.bigmap.width]+=e.value||0}}}if(core.enemys.hasSpecial(e.special,18)&&!core.hasFlag("no_snipe")){for(var c=-1;c<=1;c++){for(var d=-1;d<=1;d++){if(c==0&&d==0){continue}var l=p+c,m=q+d;if(l<0||l>=core.bigmap.width||m<0||m>=core.bigmap.height||Math.abs(c)+Math.abs(d)>1){continue}core.status.checkBlock.damage[l+m*core.bigmap.width]+=e.value||0}}}}}}core.status.checkBlock.betweenAttack=[];if(!core.hasFlag("no_betweenAttack")){for(var p=0;p<core.bigmap.width;p++){for(var q=0;q<core.bigmap.height;q++){var f=false;if(p>0&&p<core.bigmap.width-1){var h=core.status.checkBlock.map[p-1+core.bigmap.width*q],i=core.status.checkBlock.map[p+1+core.bigmap.width*q];if(core.isset(h)&&core.isset(i)&&h==i){var e=core.material.enemys[h];if(core.isset(e)&&core.enemys.hasSpecial(e.special,16)){f=true}}}if(q>0&&q<core.bigmap.height-1){var h=core.status.checkBlock.map[p+core.bigmap.width*(q-1)],i=core.status.checkBlock.map[p+core.bigmap.width*(q+1)];if(core.isset(h)&&core.isset(i)&&h==i){var e=core.material.enemys[h];if(core.isset(e)&&core.enemys.hasSpecial(e.special,16)){f=true}}}if(f){core.status.checkBlock.betweenAttack[p+core.bigmap.width*q]=true;var j=core.status.hero.hp-core.status.checkBlock.damage[p+core.bigmap.width*q];if(j>1){core.status.checkBlock.damage[p+core.bigmap.width*q]+=Math.floor((j+(core.flags.betweenAttackCeil?0:1))/2)}}}}}}},ui:{drawStatistics:function(){return["yellowDoor","blueDoor","redDoor","greenDoor","steelDoor","yellowKey","blueKey","redKey","greenKey","steelKey","redJewel","blueJewel","greenJewel","yellowJewel","redPotion","bluePotion","greenPotion","yellowPotion","superPotion","pickaxe","bomb","centerFly","poisonWine","weakWine","curseWine","superWine","sword1","sword2","sword3","sword4","sword5","shield1","shield2","shield3","shield4","shield5",]},drawAbout:function(){if(!core.isPlaying()){core.status.event={id:null,data:null};core.dom.startPanel.style.display="none"}core.lockControl();core.status.event.id="about";core.clearMap("ui");var b=48,e=36,c=416-2*b,a=416-2*e;core.setAlpha("ui",0.85);core.fillRect("ui",b,e,c,a,"#000000");core.setAlpha("ui",1);core.strokeRect("ui",b-1,e-1,c+1,a+1,"#FFFFFF",2);var d=b+24;core.canvas.ui.textAlign="left";core.fillText("ui","HTML5 魔塔样板",d,e+35,"#FFD700","bold 22px Verdana");core.fillText("ui","版本： "+core.firstData.version,d,e+80,"#FFFFFF","bold 17px Verdana");core.fillText("ui","作者： 艾之葵",d,e+112);core.fillText("ui","HTML5魔塔交流群：539113091",d,e+112+32)}},plugins:{parallelDo:function(a){if(!core.isPlaying()){return}},plugin:function(){console.log("插件编写测试");this.test=function(){console.log("插件函数执行测试")};this.drawLight=function(a,d,c){var b=core.canvas.curtain;b.mozImageSmoothingEnabled=false;b.webkitImageSmoothingEnabled=false;b.msImageSmoothingEnabled=false;b.imageSmoothingEnabled=false;core.clearMap("curtain");core.setOpacity("curtain",1);core.setAlpha("curtain",1);if(!core.isset(a)){a=0.9}if(typeof a=="number"){a=[0,0,0,a]}core.fillRect("curtain",0,0,416,416,"rgba("+a[0]+","+a[1]+","+a[2]+","+core.clamp(a[3],0,1)+")");if(!core.isset(d)||d.length==0){return}c=core.clamp(c,0,1);d.forEach(function(t){var A=t[0],B=t[1],v=t[2],u=255*(1-core.clamp(t[3],0,1));var j=parseInt(v*c),s=v-j;var h=v*2,w=A-v,z=B-v;var p=b.getImageData(w,z,h,h);for(var n=0;n<p.data.length;n+=4){var q=n/4,f=parseInt(q/h),g=q%h;var l=v-f,m=v-g,k=Math.sqrt(l*l+m*m);if(k>=v){continue}var e=p.data[n+3]-(k<j?1:(v-k)/s)*u;p.data[n+3]=core.clamp(e,0,255)}b.putImageData(p,w,z)})}}}};